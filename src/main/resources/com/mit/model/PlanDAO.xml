<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.mit.model.PlanDAO">
	<select id="getAllPlanNum" resultType="long">
		SELECT supportNo AS supportNum
		FROM tbl_support
	</select>
	
	<select id="getPlanByPlanNum" resultType="com.mit.model.PlanDTO">
		SELECT s.supportNo AS supportNum
			, s.requirement AS requirement
			, s.deliverydate AS deliveryDate
			, (SELECT PartName FROM tbl_part p WHERE p.partcode = s.partcode) AS partname
		FROM tbl_support s
		WHERE s.supportno = #{ planNum }
	</select>
	
	<select id="getCompanyInfoByPartName" resultType="com.mit.model.CompanyDTO">
		SELECT ct.contractNo AS contractNum
			, ct.unitprice AS unitPrice
			, cp.name AS companyName
			, cp.currency AS contractCurrency
			, cp.account AS companyAccount
			, cp.business_number AS businessNum
		FROM tbl_contract ct INNER JOIN company cp ON ct.code = cp.code
		WHERE ct.partcode = (SELECT partcode FROM tbl_part p WHERE p.partName = #{ partName })
	</select>
</mapper>